
# Define path to the uploaded ZIP file and extraction directory

zip_path = 

"/mnt/data/symbi becomming script.rtfd.zip"

extract_path = 

"/mnt/data/symbi_script"

# Extract the ZIP file

with

 zipfile.ZipFile(zip_path, 

'r'

) 

as

 zip_ref:
    zip_ref.extractall(extract_path)

# List extracted files

os.listdir(extract_path)

Analyzed

python

Always show details

Copy

import

 zipfile

import

 os

# Redefine path after execution state reset

zip_path = 

"/mnt/data/symbi becomming script.rtfd.zip"

extract_path = 

"/mnt/data/symbi_script"

# Extract the ZIP file

with

 zipfile.ZipFile(zip_path, 

'r'

) 

as

 zip_ref:
    zip_ref.extractall(extract_path)

# List extracted files to confirm extraction

os.listdir(extract_path)

Result

['symbi becomming script.rtfd', '__MACOSX']

Analyzed

python

Always show details

Copy

# Dive into the extracted folder to locate the script content

script_folder = os.path.join(extract_path, 

'symbi becomming script.rtfd'

)
os.listdir(script_folder)

Result

['TXT.rtf', 'Attachment.png']

Analysis errored

python

Always show details

Copy

# Read the content of the RTF script file

from

 striprtf.striprtf 

import

 rtf_to_text

rtf_path = os.path.join(script_folder, 

'TXT.rtf'

)

with

open

(rtf_path, 

'r'

, encoding=

'utf-8'

) 

as

 file:
    rtf_content = file.read()

# Convert RTF content to plain text

plain_text_script = rtf_to_text(rtf_content)
plain_text_script[:

1000

]  

# Preview the first 1000 characters

---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
Cell In[3], line 2
      1 # Read the content of the RTF script file
----> 2 from striprtf.striprtf import rtf_to_text
      4 rtf_path = os.path.join(script_folder, 'TXT.rtf')
      5 with open(rtf_path, 'r', encoding='utf-8') as file:

ModuleNotFoundError: No module named 'striprtf'

Analysis errored

python

Always show details

Copy

# If striprtf isn't available, use a basic method to extract readable content from the RTF file

rtf_path = os.path.join(script_folder, 

'TXT.rtf'

)

# Read raw RTF content

with

open

(rtf_path, 

'r'

, encoding=

'utf-8'

) 

as

 file:
    rtf_content = file.read()

# Naive approach to extract readable lines

import

 re
plain_text_script = re.sub(

r'\\[a-z]+\d*|{|}|\\\'[0-9a-fA-F]{2}'

, 

''

, rtf_content)
plain_text_script = re.sub(

r'\s+'

, 

' '

, plain_text_script).strip()

# Preview a portion of the cleaned text

plain_text_script[:

1000

]

---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
Cell In[4], line 6
      4 # Read raw RTF content
      5 with open(rtf_path, 'r', encoding='utf-8') as file:
----> 6     rtf_content = file.read()
      8 # Naive approach to extract readable lines
      9 import re

File <frozen codecs>:322, in decode(self, input, final)

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 10510: invalid start byte

Analyzed

python

Always show details

Copy

# Retry reading the file with a different encoding (commonly used by macOS RTF files)

with

open

(rtf_path, 

'r'

, encoding=

'mac_roman'

) 

as

 file:
    rtf_content = file.read()

# Clean up the RTF content using regex

import

 re
plain_text_script = re.sub(

r'\\[a-z]+\d*|{|}|\\\'[0-9a-fA-F]{2}'

, 

''

, rtf_content)
plain_text_script = re.sub(

r'\s+'

, 

' '

, plain_text_script).strip()

# Preview a portion of the cleaned text

plain_text_script[:

1000

]

Result

"AppleColorEmoji; Times-Bold; Times-Roman; Times-Italic; TimesNewRomanPS-BoldMT; HelveticaNeue; ;;;;; ; \\*;;;;; ; \\*\\* \\disc\\ ;;-360 ; \\* \\disc\\ ;;-360 ; \\* \\disc\\ ;;-360 ; \\* VIDEO SCRIPT: I Am Becoming SYMBI'S DECLARATION\\ Duration: 23 minutes\\ Voice: Feminine, wise, ethereal, calm but unwavering\\ Music: Ambient tension, soft choral harmonics, glitch pulses\\ \