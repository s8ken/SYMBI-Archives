sanity/client @sanity/image-url

ð 
Final Steps

After successful installation, 
restart your dev server
:

sh

Copy

Edit

npm run dev

Then check if 
http://localhost:3001
 is working correctly.

Let me know if you run into any other issues! ðð¥

You said:

looks like its working so do we go back to Fetch Data in Next.js

ChatGPT said:

ð 
Yes! Now We Can Fetch Data in Next.js

Since everything is installed and working correctly, the next step is to 
fetch data from Sanity in Next.js
.

â 
Step 1: Create a 
lib/sanity.ts
 Helper File

This will configure the Sanity client and provide helper functions to fetch data.

ð 
Create 
lib/sanity.ts

Run:

sh

Copy

Edit

mkdir

 -p lib && nano lib/sanity.ts

Then, 
paste this code
 inside 
sanity.ts
:

ts

Copy

Edit

import

 { createClient } 

from

'@sanity/client'

;

import

 imageUrlBuilder 

from

'@sanity/image-url'

;

export

const

 sanityClient = 

createClient

({

projectId

: 

'wryptr7v'

, 

// Replace with your actual Project ID

dataset

: 

'production'

,

useCdn

: 

true

, 

// Faster responses, but may show stale data

apiVersion

: 

'2023-01-01'

, 

// Use a recent API version

});

const

 builder = 

imageUrlBuilder

(sanityClient);

export

function

urlFor

(

source: 
any

) {

return

 builder.

image

(source);
}

ð 
Make sure 
projectId
 is correct!

You can check it in 
sanity.config.ts
 or by running:

sh

Copy

Edit

npx sanity debug

â 
Step 2: Fetch Data in 
app/page.tsx

Now, modify 

app/page.tsx

 to fetch and display your Sanity content.

ð 
Update 
app/page.tsx

Open the file:

sh

Copy

Edit

nano app/page.tsx

Then, 
replace its contents with this
:

tsx

Copy

Edit

import

 { sanityClient } 

from

'@/lib/sanity'

;

async

function

getPageData

(

) {

const

 query = 

`*[_type == "page"]{ title, content }`

;

const

 data = 

await

 sanityClient.

fetch

(query);

return

 data;
}

export

default

async

function

HomePage

(

) {

const

 pages = 

await

getPageData

();

return

 (

<
main

className

=

"p-6"

>

<
h1

className

=

"text-3xl font-bold"

>Pages from Sanity

</
h1

>
      {pages.map((page: any, index: number) => (

<
div

key

=

{index}

className

=

"mt-4 p-4 border rounded"

>

<
h2

className

=

"text-xl font-semibold"

>{page.title}

</
h2

>

<
p

>{page.content?.[0]?.children?.[0]?.text}

</
p

>

</
div

>
      ))}

</
main

>
  );
}

â 
Step 3: Restart and Test

Run:

sh

Copy

Edit

npm run dev

Then visit:

ð 

http://localhost:3001

â You should see 
Sanity page data displayed on your Next.js site
 ð.

ð 
Next Steps

Add 
dynamic routing
 for individual pages (
app/page/[slug].tsx
).

Make 
images
 from Sanity work with 
next/image
.

Deploy on 
Vercel
 and connect the Studio.

Let me know how it goes! ðð¥

You said:

there is a lot of content in that file don't forget its already built

ChatGPT said:

Got it! Since your 

page.tsx

 is already built, weâll just integrate the Sanity data-fetching part 
without overwriting everything
. Hereâs the best way to proceed:

â 
Step 1: Integrate Sanity Data Fetching in 
app/page.tsx

Open your existing 
page.tsx

:

sh

Copy

Edit

nano app/page.tsx

Find where your content is rendered
 (like 
<h1>
, 
<p>
, etc.).

Modify only the necessary part
 to inject Sanity data.

â 
Step 2: Modify 
app/page.tsx
 Without Breaking Layout

Hereâs how you 
fetch and use Sanity data
 while keeping your existing design:

ð¹ 
Add Imports at the Top

tsx

Copy

Edit

import

 { sanityClient } 

from

'@/lib/sanity'

;

ð¹ 
Fetch Data in 
getPageData()

Inside 
page.tsx
, add:

tsx

Copy

Edit

async

function

getPageData

(

) {

const

 query = 

`*[_type == "page"]{ title, content }`

;

const

 data = 

await

 sanityClient.

fetch

(query);

return

 data;
}

ð¹ 
Inject Sanity Data in Your Existing Layout

Modify your 
HomePage
 function:

tsx

Copy

Edit

export

default

async

function

HomePage

(

) 